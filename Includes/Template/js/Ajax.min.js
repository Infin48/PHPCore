$("body").on("click",'[ajax="quote"]',function(){var e=$(this).closest('[ajax-selector="block"]');$('[ajax-selector="block block-form"] .trumbowyg-editor').html('<blockquote><span data-user="'+$.trim(e.find('[ajax-selector="user_name"]').text())+'"></span>'+e.find('[ajax-selector="block-content"').html()+"</blockquote><p><br></p>")}),$('[ajax-selector="title"]').after($('[ajax-selector="title"]').clone().addClass("title-disabled")),$('[ajax="title"]').on({mouseenter:function(){if($('[ajax-selector="title"]:not(.title-disabled)').length)var e=$('[ajax-selector="title"]:not(.title-disabled)');else{e=$('[ajax-selector="title"]:not(.title-disabled)').clone();$('[ajax-selector="title"]').after(e)}e.addClass("title-active"),e.removeClass("title-disabled"),e.find('[ajax-selector="text"]').text($.trim($(this).data("title"))),e.css({left:$(this).offset().left,top:$(this).offset().top-40}),e.width()+$(this).offset().left>$("html").width()?e.addClass("title-edge"):e.removeClass("title-edge"),$('[ajax-selector="title"]').removeClass("title-disabled")},mouseleave:function(){$('.title-active[ajax-selector="title"]').removeClass("title-active").addClass("title-disabled"),setTimeout(function(){$('.title-disabled[ajax-selector="title"]').css({left:0,top:0})},500)}}),$("body").on("click",'[ajax="show"]',function(){$(this).closest('[ajax-selector="block"]').first().removeClass("block-closed"),$(this).closest('[ajax-selector="block"]').first().find('[ajax="hide"]').first().show(),$(this).hide()}),$("body").on("click",'[ajax="hide"]',function(){$(this).closest('[ajax-selector="block"]').first().addClass("block-closed"),$(this).closest('[ajax-selector="block"]').first().find('[ajax="show"]').first().show(),$(this).hide()}),$.cAjax("likes",{window:{url:"/ajax/likes/",context:{}}}),$.cAjax("get",{ajax:{url:"/ajax/get/",method:"get",context:{}},onload:{"/User":function(e){e.ajax.context.user=$(this).closest('[ajax-selector="field-row"]').find('input[type="text"]').first().val()}},success:{"/ProfilePostComment/Previous":function(e){$(this).closest('[ajax-selector="block"]').after(e.data.content),$(this).closest('[ajax-selector="block"]').first().remove()},"/User":function(e){$row=$(this).closest('[ajax-selector="field-row"]'),$field=$(this).closest('[ajax-selector="field"]'),$select=$row.find('[ajax-selector="select"]'),$list=$field.find('[ajax-selector="recipient-list"]'),0==$select.find('[value="'+e.data.user_id+'"]').length&&$select.children().length<9&&($list.find('[ajax-selector="no-recipients"]').hide(),$list.prepend('<div class="recipient" ajax-selector="recipient" data-id="'+e.data.user_id+'">'+e.data.user+'<a ajax="remove-recipient"><i class="fas fa-times"></i></a></div>'),$select.prepend('<option selected value="'+e.data.user_id+'">'+e.data.user_id+"</option>"),$list.removeClass("d-none-i")),$row.find('input[type="text"]').val("")}}}),$.cAjax("report",{ajax:{url:"/ajax/process/",method:"post",context:{}},window:{url:"/ajax/language/",context:{},submit:function(e){e.ajax.context.report_reason_text=$(this).find("textarea").val()}},success:{default:function(e,t){e.data.notice&&($notice=$(e.data.notice),$notice.find('[ajax-selector="details"]').attr("href",e.data.url),t.find('> [ajax-place="notice-reported"], > * > [ajax-place="notice-reported"]').first().replaceWith($notice),t.addClass("block-disabled"))}}}),$.cAjax("like",{ajax:{url:"/ajax/process/",method:"get",context:{}},success:{default:function(e,t){$(this).after(e.data.button);var o=t.find('[ajax-selector="likes"]');if(o.length)o.find('[ajax-selector="list"]').prepend("<span>"+e.data.you+"</span>"),o.find('[ajax-selector="count"]').html(parseInt(o.find('[ajax-selector="count"]').text())+1);else{var a=$(e.data.block);a.find('[ajax-selector="count"]').text("1"),a.find('[ajax-selector="list"]').html("<span>"+e.data.you+"</span>"),t.find('[ajax-place="likes"]').after(a)}$(this).remove()}}}),$.cAjax("unlike",{ajax:{url:"/ajax/process/",method:"get",context:{}},success:{default:function(e,t){$(this).after(e.data.button);var o=t.find('[ajax-selector="likes"]');o.find('[ajax-selector="list"]').children().length<=1?o.remove():(o.find('[ajax-selector="list"]').children().first().remove(),o.find('[ajax-selector="count"]').html(parseInt(o.find('[ajax-selector="count"]').text())-1)),$(this).remove()}}}),$.cAjax("delete",{ajax:{url:"/ajax/process/",method:"get",context:{}},window:{url:"/ajax/language/",context:{}},success:{default:function(e,t){if($trumbowyg=t.find('[ajax-selector="trumbowyg-box"]').first(),$trumbowyg.length&&($content=$trumbowyg.find('[ajax-selector="block-content"]').removeClass("trumbowyg-editor"),"/ProfilePostComment/Delete"==e.process?$trumbowyg.replaceWith('<div class="'+$content.attr("class")+'" ajax-selector="block-content">'+parseNewLines($content.html())+"</div>"):("/ProfilePost/Delete"==e.process&&$(t.find('[ajax-selector="block"]')).each(function(){$_content=$(this).find('[ajax-selector="block-content"]').removeClass("trumbowyg-editor"),$(this).find('[ajax-selector="trumbowyg-box"]').replaceWith('<div class="'+$_content.attr("class")+'" ajax-selector="block-content">'+parseNewLines($_content.html())+"</div>")}),t.find('[ajax-place="block-content"]').first().replaceWith('<div class="'+$content.attr("class")+'" ajax-selector="block-content">'+parseNewLines($content.html())+"</div>"),$trumbowyg.remove())),e.data.notice){var o=$(e.data.notice);o.find('[ajax-selector="details"]').attr("href",e.data.url),t.find('[ajax-place="notice-deleted"]').first().replaceWith(o),t.addClass("block-closed"),t.find('[ajax-selector="block-bottom"]').remove(),t.find('[ajax-selector="block block-form"]').remove(),t.find('[ajax="delete"]').first().remove(),t.addClass("block-disabled")}else t.remove()}}}),$.cAjax("editor",{ajax:{url:"/ajax/language/",context:{}},success:{default:function(e,t){$(this).after(e.data.button).remove(),$content=t.find('[ajax-selector="block-content"]').first(),$content.before('<div ajax-place="block-content"></div>'),$content.insertBefore(t.find('[ajax-selector="block-body"]').first()),$content.trumbowyg(config)},"/ProfilePostComment/Editor":function(e,t){$(this).after(e.data.button).remove(),$content=t.find('[ajax-selector="block-content"]').first().trumbowyg(config)}}}),$("body").on("click",'[ajax="remove-recipient"]',function(){var e=$(this).closest('[ajax-selector="recipient"]'),t=$(this).closest('[ajax-selector="recipient-list"]');$('[ajax-selector="select"]').find('[value="'+e.data("id")+'"]').remove(),$('[ajax-selector="recipient-list"] [data-id="'+e.data("id")+'"]').remove(),t.children().length<2&&t.find('[ajax-selector="no-recipients"]').show()}),$.cAjax("create",{ajax:{url:"/ajax/process/",method:"post",context:{}},onload:{default:function(e){e.ajax.context.text=parseNewLines($(this).closest('[ajax-selector="block block-form"]').find(".trumbowyg-editor").html())}},success:{default:function(e){$block=$(this).closest('[ajax-selector="block block-form"]'),$block.before(e.data.content),$block.find(".trumbowyg-editor").first().html(""),$('[ajax-selector="block block-empty"]').remove()},"/ProfilePost/Create":function(e){$block=$(this).closest('[ajax-selector="block block-form"]'),$block.removeClass("block-opened"),$block.find(".trumbowyg-box textarea").clone().insertBefore($block.find(".trumbowyg-box")),$block.find(".trumbowyg-editor").empty(),$block.find(".trumbowyg-box").remove(),$block.find("textarea").first().val(""),$block.find("textarea").first().attr("class",""),$('[ajax-selector="block-list"]').prepend(e.data.content),$('[ajax-selector="block block-empty"]').remove(),$block.find(".trumbowyg-editor").first().html("")},"/ProfilePostComment/Create":function(e){var t=$(this).closest('[ajax-selector="block block-form"]');t.removeClass("block-opened"),t.find(".trumbowyg-box textarea").clone().insertBefore(t.find(".trumbowyg-box")),t.find(".trumbowyg-editor").empty(),t.find(".trumbowyg-box").remove(),t.find("textarea").first().val(""),t.find("textarea").first().attr("class",""),t.before(e.data.content),$('[ajax-selector="block block-empty"]').remove(),t.find(".trumbowyg-editor").first().html("")}}}),$.cAjax("edit",{ajax:{url:"/ajax/process/",method:"post",context:{}},onload:{default:function(e,t){console.log(t.find('[ajax-selector="block-content"]').html()),e.ajax.context.text=parseNewLines(t.find('[ajax-selector="block-content"]').html())}},success:{default:function(e,t){$(this).after(e.data.button).remove(),$trumbowyg=t.find('[ajax-selector="trumbowyg-box"]').first(),$content=$trumbowyg.find('[ajax-selector="block-content"]').removeClass("trumbowyg-editor"),t.find('[ajax-place="block-content"]').replaceWith('<div class="'+$content.attr("class")+'" ajax-selector="block-content">'+parseNewLines($content.html())+"</div>"),$trumbowyg.remove()},"/ProfilePostComment/Edit":function(e,t){$(this).after(e.data.button).remove(),$trumbowyg=t.find('[ajax-selector="trumbowyg-box"]').first(),$content=$trumbowyg.find('[ajax-selector="block-content"]').removeClass("trumbowyg-editor"),$trumbowyg.replaceWith('<div class="'+$content.attr("class")+'" ajax-selector="block-content">'+parseNewLines($content.html())+"</div>")}}}),$.cAjax("execute",{ajax:{url:"/ajax/execute/",method:"get",context:{}},success:{"/User/Logout":function(){if("user"==window.location.pathname.split("/").filter(e=>e)[0])return window.location.href="/",!0;location.reload()},"/User/Mark":function(e){var t=$(this).closest('[ajax-selector="dropdown-menu"]').find('[ajax-selector="dropdown-body"]'),o=t.find('[ajax-selector="dropdown-row"]');t.children().remove(),t.prepend("<"+o.prop("tagName")+' class="'+o.attr("class")+'">'+e.data.empty+"</"+o.prop("tagName")+">"),$(this).closest('[ajax-selector="dropdown"]').find("a[data-count]").removeAttr("data-count")}}}),$.cAjax("process",{ajax:{url:"/ajax/process/",method:"get",context:{}}});