$("body").on("click",'[ajax="quote"]',function(){var e=$(this).closest('[ajax-selector="block"]');$('[ajax-selector="block block-form"] .trumbowyg-editor').html('<blockquote><span data-user="'+$.trim(e.find('[ajax-selector="user_name"]').text())+'"></span>'+e.find('[ajax-selector="block-content"').html()+"</blockquote><p><br></p>")}),$('[ajax-selector="title"]').after($('[ajax-selector="title"]').clone().addClass("title-disabled")),$('[ajax="title"]').on({mouseenter:function(){if($('[ajax-selector="title"]:not(.title-disabled)').length)var e=$('[ajax-selector="title"]:not(.title-disabled)');else{e=$('[ajax-selector="title"]:not(.title-disabled)').clone();$('[ajax-selector="title"]').after(e)}e.addClass("title-active"),e.removeClass("title-disabled"),e.find('[ajax-selector="text"]').text($.trim($(this).data("title"))),e.css({left:$(this).offset().left,top:$(this).offset().top-40}),e.width()+$(this).offset().left>$("html").width()?e.addClass("title-edge"):e.removeClass("title-edge"),$('[ajax-selector="title"]').removeClass("title-disabled")},mouseleave:function(){$('.title-active[ajax-selector="title"]').removeClass("title-active").addClass("title-disabled"),setTimeout(function(){$('.title-disabled[ajax-selector="title"]').css({left:0,top:0})},500)}}),$("body").on("click",'[ajax="show"]',function(){$(this).closest('[ajax-selector="block"]').first().removeClass("block-closed"),$(this).closest('[ajax-selector="block"]').first().find('[ajax="hide"]').first().show(),$(this).hide()}),$("body").on("click",'[ajax="hide"]',function(){$(this).closest('[ajax-selector="block"]').first().addClass("block-closed"),$(this).closest('[ajax-selector="block"]').first().find('[ajax="show"]').first().show(),$(this).hide()}),$.cAjax("create",{ajax:{url:"/ajax/process/",method:"post",context:{}},onload:function(e){e.ajax.context.text=parseNewLines($(this).closest('[ajax-selector="block block-form"]').find(".trumbowyg-editor").html())},success:function(e){var t=$(this).closest('[ajax-selector="block block-form"]');"ProfilePost"!=e.type&&"ProfilePostComment"!=e.type||(t.removeClass("block-opened"),t.find(".trumbowyg-box textarea").clone().insertBefore(t.find(".trumbowyg-box")),t.find(".trumbowyg-editor").empty(),t.find(".trumbowyg-box").remove(),t.find("textarea").first().val(""),t.find("textarea").first().attr("class","")),"ProfilePost"==e.type?$('[ajax-selector="block-list"]').prepend(e.data.content):t.before(e.data.content),$('[ajax-selector="block block-empty"]').remove(),t.find(".trumbowyg-editor").first().html("")}}),$.cAjax("next-comments",{ajax:{url:"/ajax/comments/",method:"get",context:{}},success:function(e){$(this).closest('[ajax-selector="block"]').after(e.data.content),$(this).closest('[ajax-selector="block"]').first().remove()}}),$.cAjax("all-likes",{window:{url:"/ajax/likes/",context:{}}}),$.cAjax("report",{ajax:{url:"/ajax/process/",method:"post",context:{}},window:{url:"/ajax/language/",context:{},submit:function(e){e.ajax.context.report_reason_text=$(this).find("textarea").val()}},success:function(e,t){e.data.notice&&"Topic"!=t.attr("data-type")&&($notice=$(e.data.notice),$notice.find('[ajax-selector="details"]').attr("href",e.data.url),t.find('> [ajax-place="notice-reported"], > * > [ajax-place="notice-reported"]').first().replaceWith($notice),t.addClass("block-disabled"))}}),$.cAjax("like",{ajax:{url:"/ajax/process/",method:"get",context:{}},success:function(e,t){$(this).after(e.data.button);var a=t.find('[ajax-selector="likes"]');if(a.length)a.find('[ajax-selector="list"]').prepend("<span>"+e.data.you+"</span>"),a.find('[ajax-selector="count"]').html(parseInt(a.find('[ajax-selector="count"]').text())+1);else{var o=$(e.data.block);o.find('[ajax-selector="count"]').text("1"),o.find('[ajax-selector="list"]').html("<span>"+e.data.you+"</span>"),t.find('[ajax-place="likes"]').after(o)}$(this).remove()}}),$.cAjax("unlike",{ajax:{url:"/ajax/process/",method:"get",context:{}},success:function(e,t){$(this).after(e.data.button);var a=t.find('[ajax-selector="likes"]');a.find('[ajax-selector="list"]').children().length<=1?a.remove():(a.find('[ajax-selector="list"]').children().first().remove(),a.find('[ajax-selector="count"]').html(parseInt(a.find('[ajax-selector="count"]').text())-1)),$(this).remove()}}),$.cAjax("delete",{ajax:{url:"/ajax/process/",method:"get",context:{}},window:{url:"/ajax/language/",context:{}},success:function(e,t){if(t.find(".trumbowyg-box").length&&($trumbowyg=t.find(".trumbowyg-box"),$trumbowyg.before('<div class="block-content" ajax-selector="block-content">'+parseNewLines($trumbowyg.find(".trumbowyg-editor").html())+"</div>"),$trumbowyg.remove()),e.data.notice){var a=$(e.data.notice);a.find('[ajax-selector="details"]').attr("href",e.data.url),t.find('[ajax-place="notice-deleted"]').first().replaceWith(a),t.addClass("block-closed"),t.find('[ajax-selector="block-bottom"]').remove(),t.find('[ajax-selector="block block-form"]').remove(),t.find('[ajax="delete"]').first().remove(),t.addClass("block-disabled")}else t.remove()}}),$.cAjax("editor",{ajax:{url:"/ajax/language/",context:{}},success:function(e,t){$(this).after(e.data.button),$(this).remove(),t.find('[ajax-selector="block-content"]').first().trumbowyg(config)}}),$.cAjax("edit",{ajax:{url:"/ajax/process/",method:"post",context:{}},onload:function(e,t){e.ajax.context.text=parseNewLines(t.find(".trumbowyg-editor").html())},success:function(e,t){$(this).after(e.data.button),$(this).remove(),$trumbowyg=t.find(".trumbowyg-box"),$trumbowyg.before('<div class="block-content" ajax-selector="block-content">'+parseNewLines($trumbowyg.find(".trumbowyg-editor").html())+"</div>"),$trumbowyg.remove()}}),$("body").on("click",'[ajax="remove-recipient"]',function(){var e=$(this).closest('[ajax-selector="recipient"]'),t=$(this).closest('[ajax-selector="recipient-list"]');$('[ajax-selector="select"]').find('[value="'+e.data("id")+'"]').remove(),$('[ajax-selector="recipient-list"] [data-id="'+e.data("id")+'"]').remove(),t.children().length<2&&t.find('[ajax-selector="no-recipients"]').show()}),$.cAjax("user",{ajax:{url:"/ajax/user/",method:"get",context:{}},onload:function(e){e.ajax.context.user=$(this).closest('[ajax-selector="field-row"]').find('input[type="text"]').first().val()},success:function(e){$row=$(this).closest('[ajax-selector="field-row"]'),$field=$(this).closest('[ajax-selector="field"]'),$select=$row.find('[ajax-selector="select"]'),$list=$field.find('[ajax-selector="recipient-list"]'),0==$select.find('[value="'+e.data.user_id+'"]').length&&$select.children().length<10&&($list.find('[ajax-selector="no-recipients"]').hide(),$list.prepend('<div class="recipient" ajax-selector="recipient" data-id="'+e.data.user_id+'">'+e.data.user+'<a ajax="remove-recipient"><i class="fas fa-times"></i></a></div>'),$select.prepend('<option selected value="'+e.data.user_id+'">'+e.data.user_id+"</option>"),$list.removeClass("d-none-i")),$row.find('input[type="text"]').val("")}}),$.cAjax("mark",{ajax:{url:"/ajax/mark/",method:"get",context:{}},success:function(e){var t=$(this).closest('[ajax-selector="dropdown-menu"]').find('[ajax-selector="dropdown-body"]'),a=t.find('[ajax-selector="dropdown-row"]');t.children().remove(),t.prepend("<"+a.prop("tagName")+' class="'+a.attr("class")+'">'+e.data.empty+"</"+a.prop("tagName")+">"),$(this).closest('[ajax-selector="dropdown"]').find("a[data-count]").removeAttr("data-count")}});